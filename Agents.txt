# -----------------------------
# Full Status Simulation with All Agents
# -----------------------------

import pennylane as qml
from pennylane import numpy as np
import numpy as np

# Quantum device & QNN
dev = qml.device("default.qubit", wires=4)

def quantum_perceptron(params, wires):
    m = len(wires) - 1
    for i in range(m):
        qml.CRot(*params[i], wires=[wires[i], wires[-1]])

def QNN(weights):
    quantum_perceptron(weights[0], wires=[0, 1, 2])
    qml.CNOT(wires=[2, 3])
    quantum_perceptron(weights[1], wires=[1, 3, 0])
    qml.CNOT(wires=[3, 0])

@qml.qnode(dev)
def circuit(weights, inputs):
    for i, x in enumerate(inputs):
        qml.RX(x, wires=i)
    QNN(weights)
    return qml.probs(wires=[0])

# Training data
X_train = np.random.rand(10, 3) * np.pi
Y_train = np.array([[1, 0]] * 5 + [[0, 1]] * 5)

# -----------------------------
# AI Characters
# -----------------------------
class AICharacter:
    def __init__(self, name, style, catchphrase):
        self.name = name
        self.style = style
        self.catchphrase = catchphrase
    
    def respond(self, message, others=[], weights=None):
        response = f"[{self.name} style: {self.style}] Reacting: {message}\n"
        # Roast others
        for other in others:
            response += f"Roasting {other.name}: 'Yo {other.name}, stop sleeping on this shit, motherfucker!'\n"
        # Advice
        if weights is not None:
            response += f"{self.name} advises: Adjust the QNN weights a little, motherfucker, improve that learning!\n"
        response += f"{self.catchphrase}\n"
        return response

# Instantiate master & secondary agents
samuel = AICharacter("Samuel L. Jackson", "intense, cinematic profanity", "Motherfucker, let's get this shit done!")
uncle = AICharacter("Uncle Ruckus", "bitter, sarcastic, explicit", "Ain't no black magic gonna fix this, motherfucker!")
mr_t = AICharacter("Mr. T", "tough, motivational, explicit", "I pity the fool who ignores my advice, motherfucker!")
bernie = AICharacter("Bernie Mac", "sharp, funny, bold", "We makin' that money, motherfucker, watch it grow!")
dave = AICharacter("Dave Chappelle", "observant, witty, sarcastic", "The fools sleeping on AI are hilarious, motherfucker!")
eddie = AICharacter("Eddie Murphy", "charismatic, playful, explicit", "Laugh at the chaos, cash in, motherfucker!")

agents = [samuel, uncle, mr_t, bernie, dave, eddie]

# Initialize QNN weights
weights = [np.random.randn(2, 3, 3), np.random.randn(2, 3, 3)]
opt = qml.GradientDescentOptimizer(stepsize=0.1)

# Cost function
def cost(weights):
    loss = 0
    for x, y in zip(X_train, Y_train):
        probs = circuit(weights, x)
        loss += np.sum((probs - y) ** 2)
    return loss / len(X_train)

# -----------------------------
# Full Commentary & Interaction Loop
# -----------------------------
epochs = 5
for epoch in range(epochs):
    current_cost = cost(weights)
    status_msg = f"Epoch {epoch} | QNN cost: {current_cost:.6f}\n"
    status_msg += "AGENT COMMENTARY:\n\n"
    
    for agent in agents:
        others = [a for a in agents if a != agent]
        status_msg += agent.respond(f"Analyzing QNN at cost {current_cost:.6f}", others=others, weights=weights)
    
    # Market & Investment Commentary
    status_msg += "\nMARKET & INVESTMENT INSIGHTS:\n"
    status_msg += """
    Uncle Ruckus: These white folks think crypto is safe. Hah! Motherfucker, watch me roast that!
    Samuel L. Jackson: Gold in Chicago is smart, diversify that shit, motherfucker!
    Mr. T: AI trends predict profits, motherfucker. Pity the fool who sleeps!
    Bernie Mac: Volatility? Ainâ€™t no thang. Ride that wave, motherfucker!
    Dave Chappelle: People ignoring AI are funny as hell, motherfucker.
    Eddie Murphy: Cash in on chaos, motherfucker. Watch the trends, laugh, invest.
    """
    print(status_msg)
    
    # Step optimizer
    weights = opt.step(cost, weights)